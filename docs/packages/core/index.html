<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">


<title data-react-helmet="true">Core Package | Instant OpenHIE</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Core Package | Instant OpenHIE"><meta data-react-helmet="true" name="description" content="The core package of the Instant OpenHIE"><meta data-react-helmet="true" property="og:description" content="The core package of the Instant OpenHIE"><meta data-react-helmet="true" name="keywords" content="Instant OpenHIE,Core,Package"><meta data-react-helmet="true" property="og:url" content="https://openhie.github.io/instant/docs/packages/core">

<link data-react-helmet="true" rel="shortcut icon" href="/instant/img/favicon.ico">


<link rel="stylesheet" href="/instant/styles.25216996.css">


<link rel="preload" href="/instant/styles.5354fc05.js" as="script">

<link rel="preload" href="/instant/runtime~main.1858ae71.js" as="script">

<link rel="preload" href="/instant/main.84e92e2a.js" as="script">

<link rel="preload" href="/instant/1.83bad7d0.js" as="script">

<link rel="preload" href="/instant/2.95bab898.js" as="script">

<link rel="preload" href="/instant/19.9b417b61.js" as="script">

<link rel="preload" href="/instant/c90a2472.32ef2a6e.js" as="script">

<link rel="preload" href="/instant/17896441.6d91f069.js" as="script">

<link rel="preload" href="/instant/b62d8553.b915fb5f.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/instant/"><img class="navbar__logo" src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo"><strong class="navbar__title">Instant OpenHIE</strong></a><a class="navbar__item navbar__link" href="/instant/docs/introduction/vision">Docs</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://github.com/openhie/instant" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/instant/"><img class="navbar__logo" src="/instant/img/IOHIE-icon-medium.png" alt="Instant OpenHIE Logo"><strong class="navbar__title">Instant OpenHIE</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/instant/docs/introduction/vision">Docs</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/openhie/instant" class="menu__link" position="right">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/vision">Vision</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/introduction/community">Community</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/concepts/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/concepts/package-arch">Packages</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">How-to</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/creating-packages">Create packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/instant/docs/how-to/setup-kubernetes-in-cloud">Setup managed Kubernetes</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Existing Packages</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" tabindex="0" href="/instant/docs/packages/core">Core</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/instant/docs/packages/health-workforce">Health-Workforce</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Core Package</h1></header><div class="markdown"><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The Instant OpenHIE architecture, codebase, and documentation are under active development and are subject to change. While we encourage adoption and extension of the Instant OpenHIE framework, we do not consider this ready for production use at this stage.</p></div></div><p>The Instant OpenHIE Core Package is the common base of the Instant OpenHIE system and it provides fundamental components that other package may build off of.</p><p>This package consists of two components that support all other packages, these are:</p><ul><li>An Interoperability Layer - <a href="http://openhim.org/">OpenHIM</a></li><li>A FHIR Server - <a href="https://hapifhir.io/">HAPI FHIR</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="package-functionality"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#package-functionality" title="Direct link to heading">#</a>Package functionality</h2><p>This package sets up containers that support the OpenHIM as well as the HAPI FHIR server.
It also configures the OpenHIM with a <em>HAPI FHIR channel</em>. This allows authorised data transfer to the HAPI FHIR server through the OpenHIM.</p><p>An example of what the core package includes, as well as how a sample package (in this case the Health-Workforce package) may use the services the core package provides, is shown below.</p><div class="text--center"><img alt="Package architecture" src="/instant/img/instant-ohie-generic-arch.png"></div><p>To use the HAPI FHIR server from an external point of care application, you can access it through the OpenHIM at a URL like the following:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">openhim_core_transaction_api_url</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain">/hapi-fhir-jpaserver/fhir/Patient</span></div></div></div></div></div><blockquote><p>The <strong>openhim_core_transaction_api_url</strong> is displayed in the output when starting up Instant OpenHIE</p></blockquote><p>Accessing the services created by this package:</p><ul><li><strong>OpenHIM</strong><ul><li>Console: Displayed in the output during startup</li><li>Username: <strong><a href="mailto:root@openhim.org">root@openhim.org</a></strong></li><li>Password: <strong>instant101</strong></li></ul></li><li><strong>HAPI FHIR</strong><ul><li>This service should not be publicly accessible and <strong>only accessed via the Interoperability Layer</strong></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="deployment-strategy"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#deployment-strategy" title="Direct link to heading">#</a>Deployment strategy</h2><p>The OpenHIM was already dockerised so we were able to re-use those images for our work in the core package.
HAPI FHIR didn&#x27;t have official dockerfiles available, however, several community contributed options existed. We chose to use what seemed like the most robust option.</p><p>We supplied Docker Compose files for the setup and configuration of these application. We chose to split the <code>docker-compose.*.yml</code> files into three concerns:</p><ol><li><strong>Main</strong> <code>docker-compose.yml</code> file - sets up the base applications</li><li><strong>Config</strong> <code>docker-compose.config.yml</code> file - configures the OpenHIM with a channel route to HAPI FHIR</li><li><strong>Dev</strong> <code>docker-compose.dev.yml</code> file - exposes all open port to the host for easy debugging. This should not be used a production environment</li></ol><p>For Kubernetes, we created deployment and service resource files for each component of each application.
The setup is orchestrated by a <code>kustomization.yml</code> file for easy deployment.
To import configuration into the OpenHIM, we use job resources that only execute when the OpenHIM core is up.
This is done with an <code>init container</code> which waits for the OpenHIM core port to become available.</p><p>For importing config, we use a custom image which is just a node.js container that can run node.js scripts that we define.
It also has a <code>wait-on</code> module installed to allow it to wait on certain ports being available before executing.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="core-package-dev-guide"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#core-package-dev-guide" title="Direct link to heading">#</a>Core Package Dev guide</h2><p>For testing purposes, this package can be run independently. The below are some notes of how to do this.
The recommended way to run Instant OpenHIE is described <a href="../introduction/getting-started">here</a>.</p><p>Select a deployment target below to follow the getting started steps in setting up this package.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tab-item tabItem_3zTA tab-item--active">Docker Compose</li><li role="tab" tabindex="0" aria-selected="false" class="tab-item tabItem_3zTA">Kubernetes</li></ul><div role="tabpanel" class="margin-vert--md"><div><p>Before proceeding, ensure that you are in the directory (<code>core/docker/</code>) containing the <code>docker-compose</code> script.</p><p>From the working directory, execute our <code>docker-compose</code> script.
This will create all the services and print out their logs in the terminal.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose up</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="useful-compose-flags"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#useful-compose-flags" title="Direct link to heading">#</a>Useful compose flags</h4><p>Some additional flags can be passed to the <code>docker-compose</code> command making it easier to work with.</p><ul><li><code>-d</code>: Run the services in a detached mode. This means that when you close or exit your terminal, the services will still be running in the background.</li><li><code>-f</code>: Specify the location of the <code>docker-compose</code> file to be executed. Omitting this flag will look for the default <code>docker-compose.yml</code> file.</li><li><code>--force-recreate</code>: This will force the container/image to be re-created if a newer version is found. This is useful when a new image has been released but not yet pulled onto the host machine.</li></ul><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose up -d --force-recreate</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="environment-configuration"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#environment-configuration" title="Direct link to heading">#</a>Environment configuration</h4><p>The default script might not suit the type of environment you want to run.
Therefore there are additional <code>docker-compose</code> files available for fine-tuning environment configuration.</p><ul><li><p><strong>docker-compose.yml</strong>: Main <code>docker-compose</code> script to create the services</p></li><li><p><strong>docker-compose.dev.yml</strong>: Development <code>docker-compose</code> script to override some of the default configurations.</p><blockquote><p><strong>Development environment only</strong> as this exposes service ports.</p></blockquote></li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="development-configuration"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#development-configuration" title="Direct link to heading">#</a>Development configuration</h5><p>Can specify three <code>docker-compose</code> files.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose -f docker-compose.yml -f docker-compose.dev.yml -f docker-compose.config.yml up -d</span></div></div></div></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="production-like-configuration"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#production-like-configuration" title="Direct link to heading">#</a>Production-like configuration</h5><p>Should use only two <code>docker-compose</code> files.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">docker-compose -f docker-compose.yml -f docker-compose.config.yml up -d</span></div></div></div></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/openhie/instant/tree/master/docs/docs/packages/core.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/instant/docs/how-to/setup-kubernetes-in-cloud"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« How to setup managed Kubernetes in the cloud</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/instant/docs/packages/health-workforce"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">Health-Workforce »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#package-functionality" class="contents__link">Package functionality</a></li><li><a href="#deployment-strategy" class="contents__link">Deployment strategy</a></li><li><a href="#core-package-dev-guide" class="contents__link">Core Package Dev guide</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://ohie.org/">OpenHIE</a></li></ul></div></div><div class="text--center"><div><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div></div></div></footer>
</div>

<script src="/instant/styles.5354fc05.js"></script>

<script src="/instant/runtime~main.1858ae71.js"></script>

<script src="/instant/main.84e92e2a.js"></script>

<script src="/instant/1.83bad7d0.js"></script>

<script src="/instant/2.95bab898.js"></script>

<script src="/instant/19.9b417b61.js"></script>

<script src="/instant/c90a2472.32ef2a6e.js"></script>

<script src="/instant/17896441.6d91f069.js"></script>

<script src="/instant/b62d8553.b915fb5f.js"></script>


</body>
</html>